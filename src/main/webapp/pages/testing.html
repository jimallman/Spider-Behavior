<!DOCTYPE html SYSTEM "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <meta content='text/xthml'/>
  <link type='text/css' rel='stylesheet' href='../static/spider-behavior.css'/>
  <title>Arachnolingua Test Page</title>
</head>
<body>
<pre>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js">
</script>
<script>
$(document).ready(function(){
  $("#protocol_button").click(function(){
    $.ajax({
      url: "http://arachb.org/openrdf-sesame/protocol",
      dataType: "text"
      }
    ).done(function(data, textStatus, jqXHR) {$("#protocol").text("Sesame protocol version: " + data)})
    .fail(function(jqXHR, textStatus, errorThrown) { alert("error: " + textStatus); });
    });
  $("#size_button").click(function(){
    $.ajax({
      url: "http://arachb.org/openrdf-sesame/repositories/test/size",
      dataType: "text"
      }
    ).done(function(data, textStatus, jqXHR) {$("#rep_size").text("Size of test triple store: " + data)})
    .fail(function(jqXHR, textStatus, errorThrown) { alert("error: " + textStatus); });
    });
  $("#query_button").click(function(){
    $.ajax({
      url: encodeURI("http://arachb.org/openrdf-sesame/repositories/test"),
      data: {query: "prefix obo:<http://purl.obolibrary.org/obo/> select ?publication WHERE{?publication rdf:type obo:IAO_0000312 .}"},
      dataType: "json",
      accepts: {json: "application/sparql-results+json"},
      type: "post"
      }
    ).done(function(data, textStatus, jqXHR) {$("#test_query").html("<p>Results of query to list publications in triple store: </p>" + queryTable(data))})
    .fail(function(jqXHR, textStatus, errorThrown) { alert("error: " + textStatus); });
    });
});

var queryTable = function (resultobj){
    if (resultobj.results) {
        var result = "";
        result = result + "<table border='1'>\n";
        result = result + "  <tr>\n";
        result = result + "  <th>" + resultobj.head.vars[0] + "</th>\n";
        result = result + "  </tr>\n";
        for(i=0;i < resultobj.results.bindings.length; i += 1){
           result = result + "  <tr>\n";
           result = result + "    <td>" + resultobj.results.bindings[i].publication.value + "</td>\n";
           result = result + "  </tr>\n"
        }
        result = result + "</table>";
        return result;
    }
    else {
        return "<p>No results</p>";
    }
}

</script>
</pre>
<h1>Sesame Triple Store Testing Page</h1>
<p id="protocol">Sesame protocol version unknown</p>
<br/>
<button id="protocol_button">Get Sesame Protocol Version</button>
<br/>
<p id="rep_size">Size of test triple store unknown</p>
<button id="size_button">Get Size of Test Store</button>
<br/>
<button id="query_button">List all publications by id (doi or internal)</button>
<br/>
<p id="test_query">Test query</p>

</body>
</html>
